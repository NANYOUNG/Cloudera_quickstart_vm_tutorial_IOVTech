<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>Tutorial Exercise 2</title>




  

<style>
   body { background-image : url("http://blogfiles.naver.net/20150201_187/drivesol_1422789780016gfVwj_PNG/wb3.png");
      background-position : 50% 50% ;
      background-attachment : fixed ;
      background-repeat : no-repeat; }
   </style></head><body>

<font face="Arial" size="5">

<b>Tutorial Exercise 2</b> </font><br><br>

<font face="Arial" size="3">


You'll use Hue.<br>
Hue is Graphical user interface for users of the cluster.

</font><p style="text-align: center;"><font face="Arial" size="3"><img title="ex2_1.PNG" class="__se_object" id="se_object_142278740760595790" style="border: 1px solid rgb(0, 0, 0); width: 740px; height: 506px;" src="http://blogfiles.naver.net/20150201_212/ryuhyekyung_1422787406925KVEzm_PNG/ex2_1.PNG" rwidth="740" rheight="506" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" sqeid="QE_142278740965319799" align="" border="1" height="506" width="740"><br></font></p>

<p>
<font face="Arial" size="3">Let's start Hue!
Click 'Fire Fox Icon'.
</font></p>

<p style="text-align: center;"><font face="Arial" size="3"><img title="ex2_2.png" class="__se_object" id="se_object_142278753565783269" style="border-color: rgb(0, 0, 0); width: 740px; height: 445px;" src="http://blogfiles.naver.net/20150201_44/ryuhyekyung_1422787534881WI1lo_PNG/ex2_2.png" rwidth="740" rheight="445" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" sqeid="QE_142278753724469865" align="" height="445" width="740"></font></p><p><font face="Arial" size="3"><br></font></p>


<font face="Arial" size="3">It¡¯s ¡®quickstart.cloudera¡¯ web page. <br>
Click ¡®Hue¡¯. <br>
Then Hue will be started.<br><br>


</font><p style="text-align: center;"><font face="Arial" size="3"><img title="ex2_3.png" class="__se_object" id="se_object_142278763459669373" style="border-color: rgb(0, 0, 0); width: 740px; height: 445px;" src="http://blogfiles.naver.net/20150201_269/ryuhyekyung_1422787633853F0d2G_PNG/ex2_3.png" rwidth="740" rheight="445" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" sqeid="QE_14227876358836660" align="" height="445" width="740"><br></font></p>

<font face="Arial" size="3">You'll use Hue to run some SQL queries against the data. <br>
Hue provides a web-based interface for many of the tools in CDH.<br><br>


</font><p style="text-align: center;"><font face="Arial" size="3"><img title="ex2_4.PNG" class="__se_object" id="se_object_142278770795271548" style="width: 740px; height: 443px;" src="http://blogfiles.naver.net/20150201_288/ryuhyekyung_1422787707227AACAD_PNG/ex2_4.PNG" rwidth="740" rheight="443" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="443" width="740"></font></p><p><font face="Arial" size="3"><br></font></p>

<font face="Arial" size="3">In the QuickStart VM, the administrator username for Hue is 'cloudera' and the password is 'cloudera'.</font>
<div style="text-align: center;">



<font face="Arial" size="3"><img title="ex2_5.PNG" class="__se_object" id="se_object_142278793196139100" style="width: 740px; height: 541px;" src="http://blogfiles.naver.net/20150201_294/ryuhyekyung_1422787931245qIQGc_PNG/ex2_5.PNG" rwidth="740" rheight="541" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="541" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3">



Once you are inside of Hue, click of Query Editors, and open the Impala Query Editor. </font></p>
<p>

<font face="Arial" size="3"><br style="clear: both;"></font></p>
<div style="text-align: center;"><font face="Arial" size="3"><img title="ex2_6.png" class="__se_object" id="se_object_142278793224034709" style="width: 740px; height: 526px;" src="http://blogfiles.naver.net/20150201_221/ryuhyekyung_1422787931496WVTxI_PNG/ex2_6.png" rwidth="740" rheight="526" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="526" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

You'll notice that the tables that we created in Hive are not available in Impala yet. <br>
This is because we created them outside of Impala, and Impala does not constantly check for changes to the table metadata. </font></p>
<div style="text-align: center;">


<font face="Arial" size="3"><img title="ex2_7.png" class="__se_object" id="se_object_142278793249869077" style="width: 740px; height: 539px;" src="http://blogfiles.naver.net/20150201_59/ryuhyekyung_1422787931786gYV3a_PNG/ex2_7.png" rwidth="740" rheight="539" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="539" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

To get our tables to display, paste the following into the query editor and hit Execute.</font></p>
<p>


<table style="border: 0.28pt solid rgb(0, 0, 0); border-collapse: collapse;">
<tbody><tr>
<td style="border: 0.28pt solid rgb(0, 0, 0); padding: 1.41pt 5.1pt; background: rgb(242, 242, 242) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 600pt; height: 20pt;" valign="top">

invalidate metadata

</td>
</tr></tbody></table>

<font face="Arial" size="3"><br><br>

</font></p>
<div style="text-align: center;"><font face="Arial" size="3"><img title="ex2_8.png" class="__se_object" id="se_object_142278793272871555" style="width: 740px; height: 524px;" src="http://blogfiles.naver.net/20150201_190/ryuhyekyung_1422787931997OqQuv_PNG/ex2_8.png" rwidth="740" rheight="524" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="524" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

<table style="border: 0.28pt solid rgb(0, 0, 0); border-collapse: collapse; width: 909px; height: 154px;">
<tbody><tr>
<td style="border: 0.28pt solid rgb(0, 0, 0); padding: 1.41pt 5.1pt; background: rgb(242, 242, 242) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 600pt; height: 115pt;" valign="top">"invalidate
metadata" statement
: Marks the metadata for one or all tables as stale. Required after a
table is created through the Hive shell, before the table is available
for Impala queries. The next time the current Impala node performs a
query against a table whose metadata is invalidated, Impala reloads the
associated metadata before the query proceeds. This is a relatively
expensive operation compared to the incremental metadata update done by
the REFRESH statement, so in the common scenario of adding new data
files to an existing table, prefer REFRESH rather than INVALIDATE
METADATA. If you are not familiar with the way Impala uses metadata and
how it shares the same metastore database as Hive, see Overview of
Impala Metadata and the Metastore for background information.
</td>
</tr></tbody></table>

</font></p>
<p>

<font face="Arial" size="3">Now, you click on the "Refresh Table List" icon.
</font></p>
<div style="text-align: center;">

<font face="Arial" size="3"><img title="ex2_9.png" class="__se_object" id="se_object_142278793314436024" style="width: 740px; height: 525px;" src="http://blogfiles.naver.net/20150201_5/ryuhyekyung_1422787932253CQNSB_PNG/ex2_9.png" rwidth="740" rheight="525" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="525" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

You will see your new tables.</font></p>
<div style="text-align: center;">


<font face="Arial" size="3"><img title="ex2_10.png" class="__se_object" id="se_object_142278793361672157" style="width: 740px; height: 529px;" src="http://blogfiles.naver.net/20150201_34/ryuhyekyung_1422787932710QwKYr_PNG/ex2_10.png" rwidth="740" rheight="529" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="529" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">Copy and paste
or type in the following standard SQL example queries for calculating
total revenue per product and showing the top 10 revenue generating
products : </font></p>
<p>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-collapse: collapse; width: 906px; height: 154px;">
<tbody><tr>
<td style="border: 0.28pt solid rgb(0, 0, 0); padding: 1.41pt 5.1pt; background: rgb(242, 242, 242) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 600pt; height: 115pt;" valign="top">

-- Most popular product categories <br>
select c.category_name, count(order_item_quantity) as count <br>
from order_items oi <br>
inner join products p on oi.order_item_product_id = p.product_id <br>
inner join categories c on c.category_id = p.product_category_id <br>
group by c.category_name <br>
order by count desc <br>
limit 10;

</td>
</tr></tbody></table>

</p><p>
<font face="Arial" size="3"><br><br>
Hit Execute. </font></p>
<div style="text-align: center;">

<font face="Arial" size="3"><img title="ex2_11.png" class="__se_object" id="se_object_142278793396542741" style="width: 740px; height: 542px;" src="http://blogfiles.naver.net/20150201_152/ryuhyekyung_1422787933223pUgaA_PNG/ex2_11.png" rwidth="740" rheight="542" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="542" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

You should see results of the following form :</font></p>
<div style="text-align: center;">

<font face="Arial" size="3"><img title="ex2_12.png" class="__se_object" id="se_object_142278793425360579" style="width: 740px; height: 541px;" src="http://blogfiles.naver.net/20150201_123/ryuhyekyung_1422787933567r8q7i_PNG/ex2_12.png" rwidth="740" rheight="541" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="541" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

Clear out the previous query. </font></p>
<div style="text-align: center;">

<font face="Arial" size="3"><img title="ex2_13.png" class="__se_object" id="se_object_14227879345662793" style="width: 740px; height: 372px;" src="http://blogfiles.naver.net/20150201_235/ryuhyekyung_1422787933849ud9Pb_PNG/ex2_13.png" rwidth="740" rheight="372" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="372" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

Copy and paste or type in the following standard SQL example queries : </font></p>
<p>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-collapse: collapse; width: 907px; height: 212px;">
<tbody><tr>
<td style="border: 0.28pt solid rgb(0, 0, 0); padding: 1.41pt 5.1pt; background: rgb(242, 242, 242) none repeat scroll 0%; -moz-background-clip: -moz-initial; -moz-background-origin: -moz-initial; -moz-background-inline-policy: -moz-initial; width: 600pt; height: 130.93pt;" valign="top">

-- top 10 revenue generating products <br>
select p.product_id, p.product_name, r.revenue <br>
from products p inner join <br>
(select oi.order_item_product_id, sum(cast(oi.order_item_subtotal as float)) <br>as revenue <br>
from order_items oi inner join orders o <br>
on oi.order_item_order_id = o.order_id <br>
where o.order_status &lt;&gt; 'CANCELED' <br>
and o.order_status &lt;&gt; 'SUSPECTED_FRAUD' <br>
group by order_item_product_id) r <br>
on p.product_id = r.order_item_product_id <br>
order by r.revenue desc <br>
limit 10;

</td>
</tr></tbody></table>


</p>
<div style="text-align: center;"><font face="Arial" size="3"><img title="ex2_14.png" class="__se_object" id="se_object_142278793484317040" style="width: 740px; height: 369px;" src="http://blogfiles.naver.net/20150201_45/ryuhyekyung_1422787934149Cri9q_PNG/ex2_14.png" rwidth="740" rheight="369" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="369" width="740"></font><br style="clear: both;">
</div>
<p><font face="Arial" size="3"><br style="clear: both;">

You should see results similar to this : 
</font></p>
<p style="text-align: center;">

<font face="Arial" size="3"><img title="ex2_15.png" class="__se_object" id="se_object_142278793514677689" style="width: 740px; height: 374px;" src="http://blogfiles.naver.net/20150201_85/ryuhyekyung_1422787934368evARN_PNG/ex2_15.png" rwidth="740" rheight="374" jsonvalue="%7B%7D" imgqe="true" s_subtype="photo" s_type="attachment" align="" height="374" width="740"><br></font></p>
<font face="Arial" size="3">If one of these steps fails, please reach out to our Cloudera Live Forum and get help. Otherwise continue.<br>
<br>
<br>

</font>
<p>

<font face="Arial" size="3"><b>CONCLUSION</b><br><br>
Now you have learned how to query Hive tables using Impala and that you
can use regular interfaces and tools (such as SQL) within a Hadoop
environment as well. The idea here being that you can do the same
reports you usually do, but where the architecture of Hadoop vs
traditional systems provides much larger scale and flexibility.
</font></p>
<p>


<font face="Arial" size="3"><br><br>
<font face="Arial" size="3"><br>
</font>
</font></p><div style="text-align: left;"><font face="Arial" size="3"><font style="font-weight: bold;" face="Arial" size="3">
<a href="ex1.html" ,="" target="middle">&lt;&lt;&lt; Tutorial 1</a></font><br>
</font></div>
<div style="text-align: right;"><font face="Arial" size="3"><font style="font-weight: bold;" face="Arial" size="3">
<a href="explain_3.html" ,="" target="middle">Case 2&gt;&gt;&gt;</a></font><br>
</font></div>
<font face="Arial" size="3"><font face="Arial" size="3">



<br><br>
        <iframe src="down_page.html" frameborder="1" height="115" scrolling="no" width="100%"></iframe>




</font></font></body></html>