<html>

 <head>

 </head>

  <body>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="color: rgb(49, 95, 151); letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; font-size: 20pt; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Tutorial Exercise 1 </span></p>
<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  &nbsp;  

<o:p></o:p></p><p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  &nbsp; <o:p></o:p></p><p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="color: rgb(233, 174, 43); letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; font-size: 15pt; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Ingest Structured Data </span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">In this scenario, DataCo¡¯s business question is: What products do our customers like to buy? To answer this question, the first thought might be to look at the transaction data, which should indicate what customers actually do buy and like to buy, right? </span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">This is probably something you can do in your regular RDBMS environment, but a benefit with Cloudera¡¯s platform is that you can do it at greater scale at lower cost, on the same system that you may also use for many other types of analysis. </span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  &nbsp; <o:p></o:p></p><p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">What this exercise demonstrates is how to do exactly the same thing you already know how to do, but in CDH. Seamless integration is important when evaluating any new infrastructure. Hence, it¡¯s important to be able to do what you normally do, and not break any regular BI reports or workloads over the dataset you plan to migrate. </span></p>

<p class="0" style="mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  &nbsp;<o:p></o:p></p>

<p><br></p>


image




<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">

To analyze the transaction data in the new platform, we need to ingest it into the Hadoop Distributed File System (HDFS). We need to find a tool that easily transfers structured data from a RDBMS to HDFS, while preserving structure. That enables us to query the data, but not interfere with or break any regular workload on it. 
Apache Sqoop, which is part of CDH, is that tool. The nice thing about Sqoop is that we can automatically load our relational data from MySQL into HDFS, while preserving the structure. 
With a few additional configuration parameters, we can take this one step further and load this relational data directly into a form ready to be queried by Impala (the open source analytic query engine included with CDH). Given that we may want to leverage the power of the Apache Avro file format for other workloads on the cluster (as Avro is a Hadoop optimized file format), we will take a few extra steps to load this data into Impala using the Avro file format, so it is readily available for Impala as well as other workloads. 
You should first log in to the Master Node of your cluster using SSH - you can get the credentials using the instructions on Your Cloudera Cluster. Once you are logged in, you can launch the Sqoop job: 
You should first open a terminal, which you can do by clicking the black "Terminal" icon at the top of your screen or clicking right button of mouse to see the menu.  </span></p>


<p class="1" style="text-align: justify; line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">And input the command like this :</span></p>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">
<tr>
<td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 130.93pt;">

[root@quickstart.cloudera ~] sqoop import-all-tables  \ <br>
-m 1  \ <br>
--connect jdbc:mysql://quickstart.cloudera:3306/retail_db  \ <br>
--username=retail_dba  \ <br>
--password=cloudera  \ <br>
--compression-codec=snappy  \ <br>
--as-avrodatafile  \ <br>
--warehouse-dir=/user/hive/warehouse <br>

</td>
</tr></table>

<br><br>



<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">
<tr>
<td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 346.97pt;">
[root@quickstart.cloudera ~] sqoop import-all-tables  \ <br>
¨ç<u style="text-underline: #ff0000 double; color=red">
-m 1</u> \
--connect
¨è<u style="text-underline: #ff0000 double;"> jdbc
</u>
:mysql://quickstart.cloudera:3306/retail_db  \  <br>
--username=retail_dba  \ <br>
--password=cloudera  \ <br>
¨é<u style="text-underline: #ff0000 double;"> --compression-codec=snappy \
</u>
--as-
¨ê<u style="text-underline: #ff0000 double;"> avro </u> datafile \ <br>
--warehouse-dir=/user/hive/warehouse  <br><br><br>

¨ç -m <n> : It is a command option to use n map tasks to import in parallel.<br>

¨è JDBC is a Java database connectivity technology (Java Standard Edition platform) from Oracle Corporation. This technology is an API for the Java programming language that defines how a client may access a database. It provides methods for querying and updating data in a database. JDBC is oriented towards relational databases.<br>

¨é On the command line, use the following option to enable Snappy compression.<br>
cf. Snappy is a compression/decompression library. It does not aim for maximum compression, or compatibility with any other compression library; instead, it aims for very high speeds and reasonable compression. For instance, compared to the fastest mode of zlib, Snappy is an order of magnitude faster for most inputs, but the resulting compressed files are anywhere from 20% to 100% bigger. On a single core of a Core i7 processor in 64-bit mode, Snappy compresses at about 250 MB/sec or more and decompresses at about 500 MB/sec or more.<br>
¨ê Avro is a data serialization system.
</td>
</tr></table>

<p><br></p>


<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  <o:p></o:p></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">This command may take a while to complete, but it is doing a lot. It is launching MapReduce jobs to export the data from our MySQL database, and put those export files in Avro format in HDFS. It is also creating the Avro schema, so that we can easily load our Hive tables for use in Impala later.</span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">   <o:p></o:p></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">   <o:p></o:p></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"> 

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; font-size: 15pt; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Verification step : </span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">When this command is complete, confirm that your Avro data files exist in HDFS. </span></p>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">

<tr><td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 34.71pt;">


[root@quickstart.cloudera ~] hadoop fs -ls /user/hive/warehouse


</td></tr>
</table>

<br><br>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">

<tr><td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 69.63pt;">


[comments] <br>
[root@quickstart.cloudera ~] hadoop fs ¨ç <u style="text-underline: #ff0000 double;"> -ls</u>/user/hive/warehouse <br>
¨ç -ls : is one of the most frequently used command in Linux. It shows lists files and directories.

</td></tr>
</table>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Will show a folder for each of the tables. </span></p>


<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">

<tr><td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 34.71pt;">

[root@quickstart.cloudera ~] hadoop fs -ls /user/hive/warehouse/categories/

</td></tr></table>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Will show the files that live inside of the categories folder. </span></p>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-ascii-font-family: Century Gothic; mso-font-width: 100%; mso-text-raise: 0.0pt;">Result : </span></p>

<br><br>

image

<br><br>





<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span style="letter-spacing: 0pt; font-weight: bold; mso-fareast-font-family: ÇÑÄÄ¹ÙÅÁ; mso-font-width: 100%; mso-text-raise: 0.0pt;">¡Ø </span><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; font-weight: bold; mso-font-width: 100%; mso-text-raise: 0.0pt; mso-ascii-font-family: Century Gothic;">Note : The file lists depend on quickstart version. So you can see the different result page.</span></p><p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  <o:p></o:p></p>







<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span style="letter-spacing: 0pt; font-weight: bold; mso-fareast-font-family: ÇÑÄÄ¹ÙÅÁ; mso-font-width: 100%; mso-text-raise: 0.0pt;">¡Ø </span><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; font-weight: bold; mso-font-width: 100%; mso-text-raise: 0.0pt; mso-ascii-font-family: Century Gothic;">Note : The file lists depend on quickstart version. So you can see the different result page.</span></p><p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;">  <o:p></o:p></p>


<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-font-width: 100%; mso-text-raise: 0.0pt; mso-ascii-font-family: Century Gothic;">Sqoop should also have created schema files for this data in your home directory. <br> Avro schema files : </span></p>

<br>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">

<tr><td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 34.71pt;">

[root@quickstart.cloudera ~] ls -l*.avsc
</td></tr>

</table>

<br><br>

<table style="border: 0.28pt solid rgb(0, 0, 0); border-image: none; border-collapse: collapse; mso-table-overlap: never;">


<tr><td valign="top" style="background: rgb(242, 242, 242); padding: 1.41pt 5.1pt; border: 0.28pt solid rgb(0, 0, 0); border-image: none; width: 663.31pt; height: 69.63pt;">

[comments]<br>
[root@quickstart.cloudera ~] ls ¨ç<u style="text-underline: #ff0000 double;">
-l</u>*.avsc 
<br>
¨ç -l : is the option of ls command. It is to show list one file per line.

</td></tr>

</table>

<p class="1" style="line-height: 160%; mso-pagination: none; mso-padding-alt: 0.0pt 0.0pt 0.0pt 0.0pt;"><span lang="EN-US" style="letter-spacing: 0pt; font-family: ÇÑÄÄ¹ÙÅÁ; mso-font-width: 100%; mso-text-raise: 0.0pt; mso-ascii-font-family: Century Gothic;">Should show .avsc files for the tables that were in our retail_db.
<br>
Result : </span></p>












  </body>


</html>